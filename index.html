<!doctype html>
<html lang="vi">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>DeviceHub ‚Äî H·ªçc qua tr√≤ ch∆°i & H∆∞·ªõng d·∫´n Bluetooth</title>
  <meta name="description" content="DeviceHub: trang h·ªçc qua tr√≤ ch∆°i v·ªÅ thi·∫øt b·ªã s·ªë; h∆∞·ªõng d·∫´n k·∫øt n·ªëi Bluetooth; t√†i li·ªáu, gallery & b√¨nh lu·∫≠n." />
  <!-- Tailwind Play CDN + Inter -->
  <script src="https://cdn.tailwindcss.com"></script>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;800&display=swap" rel="stylesheet">
  <style>
    :root{--accent1:#06b6d4; --accent2:#7c3aed; --muted:#6b7280}
    html,body,#root{height:100%}
    body{font-family:Inter,system-ui,-apple-system,"Segoe UI",Roboto,Arial;margin:0;background:linear-gradient(180deg,#f8fafc 0%,#ffffff 100%);color:#0f172a}
    /* dark mode manual overrides */
    body.dark{ background:linear-gradient(180deg,#0b1220 0%, #071025 100%); color:#e6eef6 }
    body.dark .card{ background:linear-gradient(180deg, rgba(255,255,255,0.03), rgba(255,255,255,0.02)); box-shadow: 0 6px 18px rgba(2,6,23,0.2) }
    .card{ background:white; border-radius:12px; padding:1rem; box-shadow: 0 8px 30px rgba(2,6,23,0.06) }
    .logo-badge{display:inline-flex;align-items:center;gap:.6rem;padding:.4rem .6rem;border-radius:10px;background:linear-gradient(135deg,var(--accent2),var(--accent1));color:white}
    .btn-primary{ background: linear-gradient(90deg,var(--accent2),var(--accent1)); color:white }
    #confetti{ position:fixed; left:0; top:0; width:100%; height:100%; pointer-events:none; z-index:9999 }
    .kbd{ background:#111827; color:white; padding:.12rem .4rem; border-radius:.35rem; font-size:.78rem }
    /* back top */
    #backTop{ display:none; position:fixed; right:20px; bottom:24px; z-index:60; padding:.6rem; border-radius:999px; box-shadow:0 8px 24px rgba(2,6,23,0.12); }
    .hidden-on-mobile{ display:inline-block } @media(max-width:768px){ .hidden-on-mobile{ display:none } }
    /* image fallback style */
    .img-fallback{ background:linear-gradient(90deg,#eef2ff,#e0f2fe); display:block }
    /* professional small */
    footer{ opacity:.85 }
  </style>
</head>
<body>
  <canvas id="confetti" aria-hidden="true"></canvas>
  <div id="root"></div>

  <!-- React UMD + Babel -->
  <script src="https://unpkg.com/react@18/umd/react.development.js"></script>
  <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
  <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>

  <script type="text/babel">
  const { useState, useEffect, useRef } = React;

  /********** Utilities **********/
  function downloadFile(filename, content, mime='text/plain'){ const blob=new Blob([content],{type:mime}); const url=URL.createObjectURL(blob); const a=document.createElement('a'); a.href=url; a.download=filename; document.body.appendChild(a); a.click(); a.remove(); URL.revokeObjectURL(url); }
  function htime(ts){ return new Date(ts).toLocaleString(); }
  function shuffle(a){ return [...a].sort(()=>Math.random()-0.5); }

  // Small audio feedback
  const Sound = (() => {
    const ctx = (window.AudioContext || window.webkitAudioContext) ? new (window.AudioContext || window.webkitAudioContext)() : null;
    function tone(f,t=0.06){ if(!ctx) return; const o=ctx.createOscillator(); const g=ctx.createGain(); o.type='sine'; o.frequency.value=f; g.gain.value=0.06; o.connect(g); g.connect(ctx.destination); o.start(); o.stop(ctx.currentTime+t); }
    return { click(){ tone(520,0.04) }, ok(){ tone(880,0.08); setTimeout(()=>tone(1200,0.05),80) }, bad(){ tone(220,0.12) } };
  })();

  // Confetti
  function fireConfetti(){ const c=document.getElementById('confetti'); if(!c) return; const ctx=c.getContext('2d'); const w=c.width=window.innerWidth; const h=c.height=window.innerHeight; const parts=[]; const cols=['#7c3aed','#06b6d4','#ffb86b','#ff7b7b','#7ee787']; for(let i=0;i<120;i++){ parts.push({x:Math.random()*w,y:-Math.random()*h*0.5,vx:(Math.random()-0.5)*6,vy:2+Math.random()*5,s:6+Math.random()*12,col:cols[Math.floor(Math.random()*cols.length)],rot:Math.random()*360,vr:(Math.random()-0.5)*8}) } let t=0; (function frame(){ ctx.clearRect(0,0,w,h); t++; for(const p of parts){ p.x+=p.vx; p.y+=p.vy; p.vy+=0.03; p.rot+=p.vr; ctx.save(); ctx.translate(p.x,p.y); ctx.rotate(p.rot*Math.PI/180); ctx.fillStyle=p.col; ctx.fillRect(-p.s/2,-p.s/2,p.s,p.s*0.6); ctx.restore(); } if(t<260) requestAnimationFrame(frame); else ctx.clearRect(0,0,w,h); })(); }

  // image fallback handler (data-url SVG basic)
  const fallbackSVG = 'data:image/svg+xml;utf8,' + encodeURIComponent(
    '<svg xmlns="http://www.w3.org/2000/svg" width="800" height="450"><rect width="100%" height="100%" fill="#eef2ff"/><text x="50%" y="50%" font-size="20" text-anchor="middle" fill="#475569" font-family="Arial">·∫¢nh kh√¥ng t·∫£i ƒë∆∞·ª£c</text></svg>'
  );

  /********** App data **********/
  const TEAM = [
    {name:'Tu·∫•n Anh', role:'Leader & Dev', bio:'Qu·∫£n l√Ω d·ª± √°n, dev ch√≠nh (React).'},
    {name:'Qu·ª≥nh Anh', role:'Content', bio:'So·∫°n n·ªôi dung, ki·ªÉm duy·ªát.'},
    {name:'Th√πy Trang', role:'UI/UX Designer', bio:'Thi·∫øt k·∫ø giao di·ªán, tr·∫£i nghi·ªám.'},
    {name:'H√† An', role:'Media', bio:'Chu·∫©n h√≥a h√¨nh ·∫£nh, gallery.'},
    {name:'Thanh B√¨nh', role:'Tester', bio:'Ki·ªÉm th·ª≠ ch·ª©c nƒÉng.'},
    {name:'L√™ √Ånh', role:'Docs', bio:'T√†i li·ªáu & b√°o c√°o.'}
  ];

  const GALLERY = [
    {id:1, src:'https://images.unsplash.com/photo-1517336714731-489689fd1ca8?w=1400&q=80&auto=format&fit=crop', alt:'Laptop v√† ƒëi·ªán tho·∫°i'},
    {id:2, src:'https://images.unsplash.com/photo-1518770660439-4636190af475?w=1400&q=80&auto=format&fit=crop', alt:'Router ph√°t Wi-Fi'},
    {id:3, src:'https://images.unsplash.com/photo-1587825140708-0b4b9d3f1f3b?w=1400&q=80&auto=format&fit=crop', alt:'USB flash drive'},
    {id:4, src:'https://images.unsplash.com/photo-1512496015851-a90fb38ba796?w=1400&q=80&auto=format&fit=crop', alt:'Ng∆∞·ªùi d√πng c·∫ßm ƒëi·ªán tho·∫°i'},
    {id:5, src:'https://images.unsplash.com/photo-1516321318423-f06f85e504b3?w=1400&q=80&auto=format&fit=crop', alt:'M√†n h√¨nh m√°y t√≠nh'}
  ];

  /********** comments storage **********/
  const COMMENTS_KEY = 'devicehub_comments_v2';
  function getComments(){ try{ return JSON.parse(localStorage.getItem(COMMENTS_KEY) || '[]'); } catch(e){ return []; } }
  function saveComments(list){ localStorage.setItem(COMMENTS_KEY, JSON.stringify(list)); }

  /********** Router (hash) **********/
  function useHashRoute(){
    const [route, setRoute] = useState(window.location.hash.slice(1) || '/');
    useEffect(()=>{ const onHash = ()=> setRoute(window.location.hash.slice(1) || '/'); window.addEventListener('hashchange', onHash); return ()=> window.removeEventListener('hashchange', onHash); },[]);
    function nav(to){ window.location.hash = to; }
    return [route, nav];
  }

  /********** UI Components **********/
  function TopBar({route, nav, dark, setDark}){
    return (
      <header className="sticky top-4 z-40 mx-4 p-3 container nav-glass flex items-center justify-between" role="banner">
        <div className="flex items-center gap-4">
          <div className="logo-badge" aria-hidden="true">
            <svg width="34" height="34" viewBox="0 0 24 24" fill="none"><rect x="2" y="4" width="20" height="12" rx="2" fill="white" opacity="0.06"/><path d="M8 9h8M8 12h6" stroke="white" strokeWidth="1.2" strokeLinecap="round"/><circle cx="8" cy="18" r="1.6" fill="white" opacity="0.9"/><circle cx="16" cy="18" r="1.6" fill="white" opacity="0.9"/></svg>
            <div>
              <div className="font-bold text-sm">DeviceHub</div>
              <div className="text-xs">H·ªçc ‚Äî Ch∆°i ‚Äî H∆∞·ªõng d·∫´n</div>
            </div>
          </div>

          <nav className="hidden md:flex gap-2 ml-3" aria-label="Main navigation">
            <button className={"px-3 py-2 rounded text-sm " + (route==='/'? 'bg-white/90 shadow' : 'text-gray-600 hover:bg-white/60')} onClick={()=>{nav('/'); Sound.click();}}>Trang ch·ªß</button>
            <button className={"px-3 py-2 rounded text-sm " + (route==='/games'? 'bg-white/90 shadow' : 'text-gray-600 hover:bg-white/60')} onClick={()=>{nav('/games'); Sound.click();}}>Tr√≤ ch∆°i</button>
            <button className={"px-3 py-2 rounded text-sm " + (route==='/guides'? 'bg-white/90 shadow' : 'text-gray-600 hover:bg-white/60')} onClick={()=>{nav('/guides'); Sound.click();}}>H∆∞·ªõng d·∫´n</button>
            <button className={"px-3 py-2 rounded text-sm " + (route==='/resources'? 'bg-white/90 shadow' : 'text-gray-600 hover:bg-white/60')} onClick={()=>{nav('/resources'); Sound.click();}}>T√†i li·ªáu</button>
            <button className={"px-3 py-2 rounded text-sm " + (route==='/team'? 'bg-white/90 shadow' : 'text-gray-600 hover:bg-white/60')} onClick={()=>{nav('/team'); Sound.click();}}>Team</button>
          </nav>
        </div>

        <div className="flex items-center gap-2">
          <button title="Ch·∫ø ƒë·ªô s√°ng/t·ªëi" aria-label="Chuy·ªÉn ch·∫ø ƒë·ªô t·ªëi" onClick={() => { setDark(d => { localStorage.setItem('dh_dark', d ? '0' : '1'); return !d }); Sound.click(); }} className="p-2 rounded border">
            {dark ? 'üåô Dark' : '‚òÄÔ∏è Light'}
          </button>
          <button onClick={()=>{ fireConfetti(); Sound.click(); }} className="p-2 hidden md:inline">üéâ</button>
          <button className="px-3 py-2 btn-primary rounded hidden-on-mobile" onClick={()=>{ nav('/comments'); Sound.click(); }}>G·ª≠i g√≥p √Ω</button>
          <button className="md:hidden p-2" onClick={() => { const m = document.getElementById('mobileMenu'); m.classList.toggle('hidden'); }} aria-label="M·ªü menu">‚ò∞</button>
        </div>

        <div id="mobileMenu" className="md:hidden hidden absolute right-4 top-20 bg-white p-3 rounded shadow">
          <button className="w-full text-left p-2" onClick={()=>{nav('/'); document.getElementById('mobileMenu').classList.add('hidden');}}>Trang ch·ªß</button>
          <button className="w-full text-left p-2" onClick={()=>{nav('/games'); document.getElementById('mobileMenu').classList.add('hidden');}}>Tr√≤ ch∆°i</button>
          <button className="w-full text-left p-2" onClick={()=>{nav('/guides'); document.getElementById('mobileMenu').classList.add('hidden');}}>H∆∞·ªõng d·∫´n</button>
          <button className="w-full text-left p-2" onClick={()=>{nav('/resources'); document.getElementById('mobileMenu').classList.add('hidden');}}>T√†i li·ªáu</button>
          <button className="w-full text-left p-2" onClick={()=>{nav('/team'); document.getElementById('mobileMenu').classList.add('hidden');}}>Team</button>
        </div>
      </header>
    );
  }

  function Breadcrumb({route}){ const map={'/':'Trang ch·ªß','/games':'Tr√≤ ch∆°i','/guides':'H∆∞·ªõng d·∫´n','/resources':'T√†i li·ªáu','/gallery':'Gallery','/team':'Team','/comments':'B√¨nh lu·∫≠n'}; return <div className="container mt-6 text-sm text-gray-600">{map[route] || 'Trang'} ‚Ä¢ DeviceHub</div>; }

  /********** Pages **********/
  // Home: includes comments at bottom (always)
  function Home({nav}){
    const topHighlights = [
      {title:'Tr√≤ ch∆°i', desc:'Quiz, Gh√©p ƒë√¥i, Memory ‚Äî ch∆°i & √¥n', to:'/games', img:GALLERY[0]},
      {title:'H∆∞·ªõng d·∫´n Bluetooth', desc:'Windows / macOS / Android / iPhone', to:'/guides', img:GALLERY[1]},
      {title:'T√†i li·ªáu', desc:'T·∫£i guide, cheat-sheet v√† slides', to:'/resources', img:GALLERY[2]}
    ];
    return (
      <main className="container mt-6">
        <section className="card">
          <div className="flex flex-col md:flex-row gap-4 items-start">
            <div className="flex-1">
              <h1 className="text-2xl font-bold">DeviceHub ‚Äî H·ªçc qua tr√≤ ch∆°i v·ªÅ thi·∫øt b·ªã s·ªë</h1>
              <p className="text-gray-600 mt-2">C·ªïng h·ªçc t·∫≠p: tr√≤ ch∆°i, h∆∞·ªõng d·∫´n k·∫øt n·ªëi Bluetooth, t√†i li·ªáu t·∫£i v·ªÅ, gallery & n∆°i trao ƒë·ªïi.</p>
              <div className="mt-4 flex gap-2">
                <button onClick={()=>nav('/games')} className="px-4 py-2 btn-primary rounded" aria-label="B·∫Øt ƒë·∫ßu ch∆°i">B·∫Øt ƒë·∫ßu ch∆°i</button>
                <button onClick={()=>nav('/guides')} className="px-4 py-2 border rounded">Xem h∆∞·ªõng d·∫´n</button>
              </div>
            </div>
            <div className="w-full md:w-80">
              <img src={GALLERY[0].src+'&w=900&q=70'} alt="Thi·∫øt b·ªã s·ªë" onError={(e)=>e.target.src=fallbackSVG} className="rounded shadow img-fallback" />
            </div>
          </div>
        </section>

        <section className="card mt-4">
          <h2 className="text-lg font-semibold">M·ª•c n·ªïi b·∫≠t</h2>
          <div className="mt-3 grid md:grid-cols-3 gap-4">
            {topHighlights.map((h,idx)=>(
              <button key={idx} onClick={()=>nav(h.to)} className="text-left p-3 border rounded hover:shadow-sm flex gap-3 items-center">
                <img src={h.img.src+'&w=400&q=60'} alt={h.img.alt} onError={(e)=>e.target.src=fallbackSVG} className="w-20 h-14 object-cover rounded"/>
                <div>
                  <div className="font-semibold">{h.title}</div>
                  <div className="text-sm text-gray-600">{h.desc}</div>
                </div>
              </button>
            ))}
          </div>
        </section>

        <section className="card mt-4">
          <h3 className="font-semibold">Gi·ªõi thi·ªáu ng·∫Øn</h3>
          <p className="text-sm text-gray-600 mt-2">Site h∆∞·ªõng t·ªõi m·ª•c ti√™u h·ªçc nhanh, th·ª±c h√†nh ngay. Gi√°o vi√™n c√≥ th·ªÉ export comments (JSON) ƒë·ªÉ thu b√†i).</p>
        </section>

        {/* Comments appear always at the bottom of homepage */}
        <section className="card mt-4">
          <CommentsCompact />
        </section>

      </main>
    );
  }

  /********** Games: Quiz, Match, Memory **********/
  const QUIZ = [
    {q:'Thi·∫øt b·ªã n√†o ƒë·ªÉ nh·∫≠p gi·ªçng n√≥i?', choices:['Microphone','Monitor','Router','Printer'], a:0},
    {q:'Bluetooth l√† g√¨?', choices:['M·ªôt h√£ng','Giao th·ª©c kh√¥ng d√¢y t·∫ßm ng·∫Øn','M√†n h√¨nh','·ªî c·ª©ng'], a:1},
    {q:'USB flash ƒë·ªÉ?', choices:['L∆∞u tr·ªØ','In ·∫•n','G·ªçi ƒëi·ªán','Ph√°t wifi'], a:0},
    {q:'USB-C c√≥?', choices:['Ch·ªâ s·∫°c','ƒêa nƒÉng (s·∫°c, truy·ªÅn d·ªØ li·ªáu, xu·∫•t h√¨nh)','Ch·ªâ in','Kh√¥ng d√πng'], a:1}
  ];

  function GamesPage(){
    return (
      <main className="container mt-6 grid gap-4">
        <div className="card">
          <h2 className="text-2xl font-bold">Tr√≤ ch∆°i</h2>
          <p className="text-sm text-gray-600 mt-1">Th·ª≠ s·ª©c v·ªõi 3 mini-game: Quiz (tr·∫Øc nghi·ªám), Match (gh√©p), Memory (l·∫≠t th·∫ª t√¨m c·∫∑p).</p>
        </div>

        <div className="grid md:grid-cols-3 gap-4">
          <div className="card"><QuizGame /></div>
          <div className="card"><MatchGame /></div>
          <div className="card"><MemoryGame /></div>
        </div>
      </main>
    );
  }

  // QuizGame (improved with feedback)
  function QuizGame(){
    const [i,setI] = useState(0), [score,setScore] = useState(0), [done,setDone]=useState(false);
    const bestK='dh_quiz_v3'; const [best, setBest] = useState(()=>Number(localStorage.getItem(bestK)||0));
    function choose(idx){
      const ok = idx === QUIZ[i].a;
      if(ok){ setScore(s=>s+1); Sound.ok(); } else Sound.bad();
      if(i+1 >= QUIZ.length){ const final = score + (ok?1:0); setDone(true); if(final > best){ localStorage.setItem(bestK,String(final)); setBest(final); } setTimeout(()=>fireConfetti(),200); }
      else setI(i+1);
    }
    return (
      <div>
        <div className="flex items-center justify-between">
          <div><strong>Quiz</strong><div className="text-xs text-gray-500">√în nhanh</div></div>
          <div className="text-xs text-gray-500">Best: {best || '-'}</div>
        </div>
        <div className="mt-3">
          {!done ? (
            <>
              <div className="text-sm text-gray-600 mb-2">C√¢u {i+1}/{QUIZ.length}</div>
              <div className="font-medium">{QUIZ[i].q}</div>
              <div className="grid gap-2 mt-3">
                {QUIZ[i].choices.map((c,idx)=>(<button key={idx} onClick={()=>choose(idx)} className="p-2 rounded border text-left">{c}</button>))}
              </div>
            </>
          ) : (
            <div className="text-center">
              <div className="text-lg font-bold">Ho√†n th√†nh üéâ</div>
              <div className="mt-2">ƒêi·ªÉm: <strong>{score}</strong> / {QUIZ.length}</div>
              <div className="mt-3"><button onClick={()=>{ setI(0); setScore(0); setDone(false); }} className="px-3 py-1 border rounded">Ch∆°i l·∫°i</button></div>
            </div>
          )}
        </div>
      </div>
    );
  }

  // MatchGame (click pairs)
  const MATCH_ITEMS = [
    {id:'phone', name:'ƒêi·ªán tho·∫°i', hint:'G·ªçi, nh·∫Øn tin, ch·ª•p ·∫£nh'},
    {id:'router', name:'Router', hint:'Ph√°t Wi-Fi cho nh√†'},
    {id:'printer', name:'M√°y in', hint:'In t√†i li·ªáu gi·∫•y'},
    {id:'usb', name:'USB flash', hint:'L∆∞u tr·ªØ file di ƒë·ªông'}
  ];

  function MatchGame(){
    const [left,setLeft] = useState(()=>shuffle(MATCH_ITEMS));
    const [right,setRight] = useState(()=>shuffle(MATCH_ITEMS.map(i=>({...i,face:i.hint}))));
    const [sel,setSel] = useState(null); const [matches,setMatches]=useState([]); const [moves,setMoves]=useState(0);
    const bestK='dh_match_v3'; const [best,setBest]=useState(()=>Number(localStorage.getItem(bestK)||0));
    function pickLeft(it){ setSel({side:'L', it}); }
    function pickRight(it){
      if(!sel){ setSel({side:'R', it}); return; }
      let a,b; if(sel.side==='L'){ a=sel.it; b=it } else { a=it; b=sel.it }
      setMoves(m=>m+1);
      if(a.id===b.id){ setMatches(m=>{ const next=[...m,a.id]; if(next.length===MATCH_ITEMS.length){ const final=moves+1; if(best===0 || final<best){ localStorage.setItem(bestK,String(final)); setBest(final); } setTimeout(()=>fireConfetti(),200); } return next }); Sound.ok(); } else Sound.bad();
      setSel(null);
    }
    return (
      <div>
        <div className="flex items-center justify-between">
          <div><strong>Gh√©p ƒë√¥i</strong><div className="text-xs text-gray-500">T√™n ‚Üî ch·ª©c nƒÉng</div></div>
          <div className="text-xs text-gray-500">Moves: {moves} | Best: {best||'-'}</div>
        </div>
        <div className="mt-3 grid grid-cols-2 gap-3">
          <div>
            <div className="text-xs text-gray-400 mb-2">T√™n thi·∫øt b·ªã</div>
            <div className="grid gap-2">
              {left.map(it=>(<button key={it.id} disabled={matches.includes(it.id)} onClick={()=>pickLeft(it)} className={`p-2 text-left border rounded ${sel?.it?.id===it.id && sel.side==='L' ? 'ring-2 ring-indigo-300' : ''} ${matches.includes(it.id)? 'opacity-40 line-through' : ''}`}>{it.name}</button>))}
            </div>
          </div>
          <div>
            <div className="text-xs text-gray-400 mb-2">Ch·ª©c nƒÉng</div>
            <div className="grid gap-2">
              {right.map(it=>(<button key={it.id} disabled={matches.includes(it.id)} onClick={()=>pickRight(it)} className={`p-2 text-left border rounded ${sel?.it?.id===it.id && sel.side==='R' ? 'ring-2 ring-indigo-300' : ''} ${matches.includes(it.id)? 'opacity-40 line-through' : ''}`}>{it.face}</button>))}
            </div>
          </div>
        </div>
        <div className="mt-3 flex items-center justify-between">
          <div>{matches.length}/{MATCH_ITEMS.length} ƒë√£ gh√©p</div>
          <div><button onClick={()=>{ setLeft(shuffle(MATCH_ITEMS)); setRight(shuffle(MATCH_ITEMS.map(i=>({...i,face:i.hint}))); setMatches([]); setMoves(0); setSel(null); }} className="px-3 py-1 border rounded">L√†m l·∫°i</button></div>
        </div>
        {matches.length===MATCH_ITEMS.length && <div className="mt-3 p-3 bg-green-50 rounded">Ho√†n t·∫•t! B·∫°n d√πng {moves} l∆∞·ª£t üéâ</div>}
      </div>
    );
  }

  // Memory flip game: find pairs
  function MemoryGame(){
    const base = [
      {id:'phone', label:'üì± ƒêi·ªán tho·∫°i'},
      {id:'usb', label:'üíæ USB'},
      {id:'printer', label:'üñ®Ô∏è M√°y in'},
      {id:'router', label:'üì∂ Router'},
    ];
    const pairs = shuffle([...base, ...base].map((x,idx)=>({...x, uid: x.id + '_' + idx})));
    const [cards, setCards] = useState(pairs);
    const [flipped, setFlipped] = useState([]); const [matched, setMatched] = useState([]); const [moves,setMoves] = useState(0);
    function flipCard(c){
      if(flipped.includes(c.uid) || matched.includes(c.id)) return;
      const next = [...flipped, c.uid]; setFlipped(next);
      if(next.length===2){
        setMoves(m=>m+1);
        const a = cards.find(x=>x.uid===next[0]); const b = cards.find(x=>x.uid===next[1]);
        if(a.id===b.id){ setMatched(m=>[...m,a.id]); setFlipped([]); Sound.ok(); if(matched.length+1 === base.length) setTimeout(()=>fireConfetti(),300); }
        else { Sound.bad(); setTimeout(()=>setFlipped([]),650); }
      }
    }
    function reset(){ setCards(shuffle([...base, ...base].map((x,idx)=>({...x, uid: x.id + '_' + idx}))); setMatched([]); setFlipped([]); setMoves(0); }
    return (
      <div>
        <div className="flex items-center justify-between"><div><strong>Memory</strong><div className="text-xs text-gray-500">L·∫≠t th·∫ª t√¨m c·∫∑p</div></div><div className="text-xs text-gray-500">Moves: {moves}</div></div>
        <div className="mt-3 grid grid-cols-4 gap-2">
          {cards.map(c=>(
            <button key={c.uid} onClick={()=>flipCard(c)} className="p-3 border rounded bg-white h-20 flex items-center justify-center text-lg" aria-label={c.label}>
              { flipped.includes(c.uid) || matched.includes(c.id) ? c.label : '‚ùì' }
            </button>
          ))}
        </div>
        <div className="mt-3 flex justify-end"><button onClick={reset} className="px-3 py-1 border rounded">L√†m l·∫°i</button></div>
      </div>
    );
  }

  /********** Guides / Resources / Gallery / Team / Comments compact **********/
  function Guides(){ return (
    <main className="container mt-6">
      <div className="card">
        <h2 className="text-2xl font-bold">H∆∞·ªõng d·∫´n k·∫øt n·ªëi Bluetooth & Truy·ªÅn file</h2>
        <p className="text-sm text-gray-600 mt-1">C√°c b∆∞·ªõc chi ti·∫øt theo h·ªá ƒëi·ªÅu h√†nh + m·∫πo x·ª≠ l√Ω s·ª± c·ªë.</p>
        <div className="mt-4 grid md:grid-cols-2 gap-4">
          <div>
            <h4 className="font-semibold">Windows 10 / 11</h4>
            <ol className="list-decimal pl-5 mt-2 text-sm text-gray-700">
              <li>B·∫≠t Bluetooth tr√™n ƒëi·ªán tho·∫°i ‚Üí ƒë·ªÉ visible.</li>
              <li>Windows: Settings ‚Üí Bluetooth & devices ‚Üí Add device ‚Üí Bluetooth ‚Üí ch·ªçn t√™n ƒëi·ªán tho·∫°i.</li>
              <li>X√°c nh·∫≠n m√£ gh√©p; ƒë·ªÉ g·ª≠i file: ƒëi·ªán tho·∫°i ‚Üí Share ‚Üí Bluetooth ‚Üí ch·ªçn PC; PC ch·∫•p nh·∫≠n file v√† ch·ªçn n∆°i l∆∞u.</li>
            </ol>
          </div>
          <div>
            <h4 className="font-semibold">macOS</h4>
            <ol className="list-decimal pl-5 mt-2 text-sm text-gray-700">
              <li>System Settings ‚Üí Bluetooth ‚Üí Pair.</li>
              <li>V·ªõi Android d√πng Bluetooth File Exchange; iPhone d√πng AirDrop ƒë·ªÉ chia s·∫ª v·ªõi Mac.</li>
            </ol>
          </div>
        </div>
        <div className="mt-4">
          <h4 className="font-semibold">M·∫πo nhanh</h4>
          <ul className="list-disc pl-5 text-sm text-gray-700">
            <li>T·∫Øt/b·∫≠t Bluetooth n·∫øu l·ªói; Forget device r·ªìi pair l·∫°i.</li>
            <li>Ki·ªÉm tra driver (Windows); d√πng c√°p/Wi-Fi transfer n·∫øu c·∫ßn t·ªëc ƒë·ªô cao.</li>
          </ul>
        </div>
      </div>
    </main>
  ); }

  function Resources(){
    // categorized resources
    const categories = {
      'Guides': [
        {id:'g1', title:'H∆∞·ªõng d·∫´n Bluetooth (MD)', filename:'HuongDan_Bluetooth.md', content:'# H∆∞·ªõng d·∫´n Bluetooth\\nN·ªôi dung...' }
      ],
      'Cheatsheets': [
        {id:'c1', title:'Cheat-sheet: C·ªïng ph·ªï bi·∫øn (TXT)', filename:'Cheatsheet_ports.txt', content:'USB-C: ...' }
      ],
      'Slides': [
        {id:'s1', title:'Slides: Thi·∫øt b·ªã s·ªë (PPTX)', filename:'slides-sample.txt', content:'(Trong b√†i t·∫≠p th·ª±c t·∫ø, upload PPTX v√†o repo)' }
      ]
    };
    return (
      <main className="container mt-6">
        <div className="card">
          <h2 className="text-2xl font-bold">T√†i li·ªáu</h2>
          <p className="text-sm text-gray-600 mt-1">Danh m·ª•c r√µ r√†ng: ch·ªçn m·ª•c ‚Üí t·∫£i t√†i li·ªáu.</p>
          <div className="mt-4">
            {Object.keys(categories).map(cat=>(
              <div key={cat} className="mb-4">
                <h4 className="font-semibold">{cat}</h4>
                <div className="mt-2 grid gap-2">
                  {categories[cat].map(item=>(
                    <div key={item.id} className="flex items-center justify-between border rounded p-3">
                      <div>
                        <div className="font-semibold">{item.title}</div>
                        <div className="text-xs text-gray-500">{item.filename}</div>
                      </div>
                      <div className="flex gap-2">
                        <button className="px-3 py-1 border rounded" onClick={()=>downloadFile(item.filename, item.content, item.filename.endsWith('.md')? 'text/markdown' : 'text/plain')}>T·∫£i</button>
                        <button className="px-3 py-1 rounded" onClick={()=>navigator.clipboard?.writeText(item.content).then(()=>alert('ƒê√£ copy n·ªôi dung'))}>Copy</button>
                      </div>
                    </div>
                  ))}
                </div>
              </div>
            ))}
            <div className="text-xs text-gray-500">Mu·ªën upload PDF/Slides: Add file ‚Üí Upload files tr√™n GitHub repo ‚Üí paste link v√†o ƒë√¢y (m√¨nh h∆∞·ªõng d·∫´n n·∫øu c·∫ßn).</div>
          </div>
        </div>
      </main>
    );
  }

  function Gallery(){
    return (
      <main className="container mt-6">
        <div className="card">
          <h2 className="text-2xl font-bold">Gallery</h2>
          <div className="mt-3 grid sm:grid-cols-2 md:grid-cols-3 gap-3">
            {GALLERY.map(img=>(
              <button key={img.id} onClick={()=>openLightbox(img)} className="rounded overflow-hidden shadow">
                <img src={img.src+'&w=800&q=70'} alt={img.alt} onError={(e)=>e.target.src=fallbackSVG} className="w-full h-44 object-cover" />
              </button>
            ))}
          </div>
        </div>
      </main>
    );
  }

  function Team(){
    function downloadTeam(){ const txt = TEAM.map(t=>`${t.name} ‚Äî ${t.role} ‚Äî ${t.bio}`).join('\\n'); downloadFile('team-info.txt', txt); }
    return (
      <main className="container mt-6">
        <div className="card">
          <h2 className="text-2xl font-bold">Th√¥ng tin th√†nh vi√™n</h2>
          <p className="text-sm text-gray-600 mt-1">Leader: <strong>Tu·∫•n Anh</strong>. Danh s√°ch th√†nh vi√™n & vai tr√≤:</p>
          <div className="mt-4 grid md:grid-cols-3 gap-3">
            {TEAM.map((m, i)=>(
              <div key={i} className="p-3 border rounded">
                <div className="flex items-center gap-3">
                  <div className="w-12 h-12 rounded-full bg-gray-100 flex items-center justify-center font-bold text-lg">{m.name.split(' ')[0].slice(0,1)}</div>
                  <div>
                    <div className="font-semibold">{m.name} {m.name==='Tu·∫•n Anh' && <span className="text-indigo-600 text-xs">‚Äî Leader</span>}</div>
                    <div className="text-xs text-gray-500">{m.role}</div>
                  </div>
                </div>
                <div className="mt-2 text-sm text-gray-700">{m.bio}</div>
              </div>
            ))}
          </div>
          <div className="mt-4 flex gap-2">
            <button className="px-3 py-2 btn-primary rounded" onClick={()=>{ downloadTeam(); Sound.click(); }}>T·∫£i team-info</button>
            <button className="px-3 py-2 border rounded" onClick={()=>downloadFile('team.json', JSON.stringify(TEAM, null, 2), 'application/json')}>Export JSON</button>
          </div>
        </div>
      </main>
    );
  }

  // Comments compact (used on home) and full page below
  function CommentsCompact(){
    const [list, setList] = useState(getComments());
    const [name,setName]=useState(''); const [text,setText]=useState('');
    useEffect(()=>setList(getComments()),[]);
    function post(){ if(!name.trim()||!text.trim()){ alert('Nh·∫≠p t√™n & n·ªôi dung'); return; } const c={id:Date.now(), name:name.trim(), text:text.trim(), ts:Date.now()}; const arr=[c, ...getComments()]; saveComments(arr); setList(arr); setName(''); setText(''); Sound.click(); }
    function exportJSON(){ downloadFile('comments.json', JSON.stringify(getComments(), null, 2), 'application/json'); }
    return (
      <div>
        <div className="flex items-center justify-between">
          <div><strong>B√¨nh lu·∫≠n & G√≥p √Ω</strong><div className="text-xs text-gray-500">(Hi·ªÉn th·ªã tr√™n Trang ch·ªß)</div></div>
          <div className="text-xs text-gray-500">T·ªïng: {list.length}</div>
        </div>
        <div className="mt-3 grid md:grid-cols-3 gap-2">
          <input value={name} onChange={e=>setName(e.target.value)} placeholder="T√™n" className="p-2 border rounded" />
          <input value={text} onChange={e=>setText(e.target.value)} placeholder="N·ªôi dung g√≥p √Ω" className="p-2 border rounded md:col-span-2" />
        </div>
        <div className="mt-2 flex gap-2">
          <button className="px-3 py-2 btn-primary rounded" onClick={post}>G·ª≠i</button>
          <button className="px-3 py-2 border rounded" onClick={exportJSON}>Export JSON</button>
        </div>
        <div className="mt-3">
          {list.slice(0,4).map(c=>(
            <div key={c.id} className="border rounded p-3 mb-2">
              <div className="flex items-start justify-between">
                <div><div className="font-semibold">{c.name}</div><div className="text-xs text-gray-500">{htime(c.ts)}</div></div>
              </div>
              <div className="mt-2">{c.text}</div>
            </div>
          ))}
          {list.length>4 && <div className="text-sm text-gray-500">Xem th√™m ·ªü trang <a href="#/comments" className="text-indigo-600">B√¨nh lu·∫≠n</a></div>}
        </div>
      </div>
    );
  }

  function CommentsPage(){
    const [list, setList] = useState(getComments()); const [name,setName]=useState(''); const [text,setText]=useState('');
    useEffect(()=>setList(getComments()),[]);
    function post(){ if(!name.trim()||!text.trim()){ alert('Nh·∫≠p t√™n & n·ªôi dung'); return; } const c={id:Date.now(), name:name.trim(), text:text.trim(), ts:Date.now()}; const arr=[c, ...getComments()]; saveComments(arr); setList(arr); setName(''); setText(''); Sound.click(); }
    return (
      <main className="container mt-6">
        <div className="card">
          <h2 className="text-2xl font-bold">B√¨nh lu·∫≠n & G√≥p √Ω</h2>
          <div className="mt-3 grid md:grid-cols-3 gap-2">
            <input value={name} onChange={e=>setName(e.target.value)} placeholder="T√™n" className="p-2 border rounded" />
            <input value={text} onChange={e=>setText(e.target.value)} placeholder="N·ªôi dung g√≥p √Ω" className="p-2 border rounded md:col-span-2" />
          </div>
          <div className="mt-2 flex gap-2">
            <button className="px-3 py-2 btn-primary rounded" onClick={post}>G·ª≠i</button>
            <button className="px-3 py-2 border rounded" onClick={()=>downloadFile('comments.json', JSON.stringify(getComments(), null, 2), 'application/json')}>Export JSON</button>
            <button className="px-3 py-2 rounded" onClick={()=>{ if(confirm('X√≥a t·∫•t c·∫£ comment c·ª•c b·ªô?')){ saveComments([]); setList([]); }}}>X√≥a t·∫•t c·∫£ (local)</button>
          </div>
          <div className="mt-4">
            {list.length===0 && <div className="text-sm text-gray-500">Ch∆∞a c√≥ b√¨nh lu·∫≠n</div>}
            {list.map(c=>(
              <div key={c.id} className="border rounded p-3 mb-2">
                <div className="flex items-start justify-between"><div><div className="font-semibold">{c.name}</div><div className="text-xs text-gray-500">{htime(c.ts)}</div></div></div>
                <div className="mt-2">{c.text}</div>
              </div>
            ))}
          </div>
        </div>
      </main>
    );
  }

  /********** Lightbox (simple) **********/
  const lb = { open: null };
  function openLightbox(img){ if(lb.open) lb.open(img); }
  function Lightbox(){
    const [img,setImg] = useState(null);
    useEffect(()=>{ lb.open = (i)=>setImg(i); },[]);
    if(!img) return null;
    return (
      <div className="fixed inset-0 z-50 flex items-center justify-center bg-black/60" onClick={()=>setImg(null)} role="dialog" aria-modal="true">
        <div className="bg-white rounded shadow max-w-3xl w-full" onClick={e=>e.stopPropagation()}>
          <img src={img.src+'&w=1600&q=80'} alt={img.alt} onError={(e)=>e.target.src=fallbackSVG} className="w-full object-contain max-h-[80vh]" />
          <div className="p-3 flex items-center justify-between">
            <div className="font-semibold">{img.alt}</div>
            <div>
              <button className="px-3 py-1 border rounded mr-2" onClick={()=>downloadFile('image.jpg', img.src)}>T·∫£i</button>
              <button className="px-3 py-1 btn-primary rounded" onClick={()=>setImg(null)}>ƒê√≥ng</button>
            </div>
          </div>
        </div>
      </div>
    );
  }

  /********** App (router + dark mode state) **********/
  function App(){
    const [route, nav] = useHashRoute();
    const [dark, setDark] = useState(() => localStorage.getItem('dh_dark') === '1' );
    useEffect(()=>{ document.body.classList.toggle('dark', dark); },[dark]);
    useEffect(()=>{ if(!window.location.hash) window.location.hash = '/'; // keyboard shortcuts
      const h=(e)=>{ if(e.target.tagName==='INPUT' || e.target.tagName==='TEXTAREA') return; if(e.key.toLowerCase()==='h') window.location.hash='/'; if(e.key.toLowerCase()==='g') window.location.hash='/games'; if(e.key.toLowerCase()==='t') window.location.hash='/team'; if(e.key.toLowerCase()==='c') window.location.hash='/comments'; }
      window.addEventListener('keydown', h); return ()=>window.removeEventListener('keydown', h); },[]);
    useEffect(()=>{ // back to top button display
      const btn = document.getElementById('backTop'); const onScroll=()=>{ if(window.scrollY>200) btn.style.display='block'; else btn.style.display='none'; }; window.addEventListener('scroll', onScroll); return ()=>window.removeEventListener('scroll', onScroll);
    },[]);

    function renderRoute(){
      if(route === '/') return <Home nav={nav} />;
      if(route === '/games') return <GamesPage />;
      if(route === '/guides') return <Guides />;
      if(route === '/resources') return <Resources />;
      if(route === '/gallery') return <Gallery />;
      if(route === '/team') return <Team />;
      if(route === '/comments') return <CommentsPage />;
      return <Home nav={nav} />;
    }

    return (
      <div>
        <TopBar route={route} nav={nav} dark={dark} setDark={setDark} />
        <Breadcrumb route={route} />
        {renderRoute()}
        <Lightbox />
        <footer className="container mt-8 mb-8 text-sm text-gray-600">¬© {new Date().getFullYear()} ‚Äî DeviceHub. Leader: Tu·∫•n Anh. Th√†nh vi√™n: Qu·ª≥nh Anh, Th√πy Trang, H√† An, Thanh B√¨nh, L√™ √Ånh.</footer>

        <button id="backTop" onClick={()=>window.scrollTo({top:0,behavior:'smooth'})} aria-label="L√™n ƒë·∫ßu trang" className="hidden" style="background:linear-gradient(90deg,var(--accent2),var(--accent1)); color:white;">‚Üë</button>
      </div>
    );
  }

  // render app
  const root = ReactDOM.createRoot(document.getElementById('root'));
  root.render(<App />);

  </script>
</body>
</html>
